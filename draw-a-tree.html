<!DOCTYPE html>
<html>
    <head>
        <title>Draw a tree</title>

        <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/d3/7.0.0/d3.min.js"></script>
        
    </head>

    <body style="text-align: center;">
        <h1>Draw a tree</h1>
        <section>
            <p>Input data (level order with nulls, like a heap):</p>
            <p>
                <textarea id="my_data" style="width:90%" rows="4"
                placeholder="[1,2,null,3,4]"
                ></textarea>
            </p>
            <p id="error"></p>
            <div>
                <button class="btn" id="btn_draw">Draw the tree</button>
            </div>
        </section>

        <section>
            <svg id="tree" style="width:90%; min-height:800px;">
                
            </svg>
        </section>
        

    </body>

    <script>
        let helper = {
            get_data: null, // function
            clear_canvas: null, // function
            add_node: null, // function - template for node

            // elements
            data_input: $('#my_data'),
            error: $('#error'),
            canvas: d3.select('#tree'),
            button: $('#btn_draw')
        };

        (function(o){
            o.clear_canvas = function(){
                d3.select("#tree >*").remove();
            };

            o.add_node = function(x,y,val){
                o.canvas.append("circle")
                .attr("cx",x)
                .attr("cy",y)
                .attr("r",10)
                .attr("stroke","black")
                .attr("fill", "white");

                o.canvas.append("text")
                .text(val)
                .attr("x",x-4)
                .attr("y",y+4);
            };

            o.get_data = function(){
                let data = null;
                // get data first
                try {
                    o.error.text('');
                    data = JSON.parse(o.data_input.val());
                } catch (err){
                    console.error(err);
                    o.error.text(err);
                    return;
                }
                
                if(data.length<1) {
                    o.error.text('Nothing to show...'); 
                    return;
                }

                if(data[i]==null) {
                    o.error.text('Root shouldn\'t be null');
                    return;
                }

                // check parent
                for(let i=1; i<data.length; i++){
                    if(data[i]!==null){
                        let parent_index = Math.floor((i-1)/2);
                        if(data[parent_index] === null) {
                            o.error.text('Null can\'t have a child');
                            return;
                        }
                    }
                }

                // clear canvas
                o.clear_canvas();

                // calc nodes x,y cordination
                let base_y = 20, base_x = 400;




                
            };

            o.button.on('click', o.get_data);


        })(helper);

    </script>
</html>